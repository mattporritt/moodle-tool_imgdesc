define("tool_imgdesc/describe",["exports","core/ajax"],(function(_exports,_ajax){var obj;
/**
   * AI Subsystem policy functions.
   *
   * @module     core_ai/repository
   * @copyright  Matt Porritt <matt.porritt@moodle.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   * @since      4.5
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.generate=void 0,_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};const toggleFooterButtons=(uniqid,show)=>{const footer=document.getElementById("".concat(uniqid,"-footer"));footer&&(show?footer.classList.remove("d-none"):footer.classList.add("d-none"))},renderDescription=(target,description)=>{target.removeAttribute("aria-busy"),target.classList.remove("bg-light");const escaped=document.createElement("div");escaped.textContent=description||"",target.innerHTML='<div class="text-body">'.concat(escaped.innerHTML.replace(/\n/g,"<br>"),"</div>")},generate=async(textboxId,contextid,itemid,uniqid)=>{const requestobj={methodname:"tool_imgdesc_describe_image",args:{contextid:contextid,itemid:itemid}},textarea=document.getElementById(textboxId);try{const responseObj=await _ajax.default.call([requestobj])[0];responseObj.error?renderDescription(textarea,responseObj.error):renderDescription(textarea,responseObj.generatedcontent)}catch(error){renderDescription(textarea,error)}toggleFooterButtons(uniqid,!0)};_exports.generate=generate;_exports.init=(textboxId,contextid,itemid,uniqid)=>(((uniqid,textboxId,contextid,itemid)=>{const regen=document.getElementById("".concat(uniqid,"-btn-regenerate")),reset=document.getElementById("".concat(uniqid,"-btn-newimage"));regen&&regen.addEventListener("click",(async e=>{e.preventDefault(),toggleFooterButtons(uniqid,!1),await generate(textboxId,contextid,itemid,uniqid)})),reset&&reset.addEventListener("click",(e=>{e.preventDefault(),window.location.href=window.location.pathname+window.location.search}))})(uniqid,textboxId,contextid,itemid),generate(textboxId,contextid,itemid,uniqid))}));

//# sourceMappingURL=describe.min.js.map